An error occurred while executing the following cell:
------------------
# 1x1 conv is same as multiplying each feature column at each pixel
# by a fully connected matrix
def corr2d_multi_in_out_1x1(X, K):
    c_i, h, w = X.shape
    c_o = K.shape[0]
    X = X.reshape((c_i, h * w))
    K = K.reshape((c_o, c_i))
    Y = torch.matmul(K, X)  # Matrix multiplication in the fully-connected layer
    return Y.reshape((c_o, h, w))


X = torch.normal(0, 1, (3, 3, 3))  # 3 channels per pixel
K = torch.normal(0, 1, (2, 3, 1, 1))  # map from 3 channels to 2

Y1 = corr2d_multi_in_out_1x1(X, K)
Y2 = corr2d_multi_in_out(X, K)
print(Y2.shape)
assert float(torch.abs(Y1 - Y2).sum()) < 1e-6
------------------

---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
/tmp/ipykernel_4030/2674749559.py in <module>
     16 Y2 = corr2d_multi_in_out(X, K)
     17 print(Y2.shape)
---> 18 assert float(torch.abs(Y1 - Y2).sum()) < 1e-6

AssertionError: 
AssertionError: 
